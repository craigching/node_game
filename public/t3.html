<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>Tic Tac Toe</title>

    <style type="text/css">
        @import "dojo-1.7.0b2/dijit/themes/claro/document.css";
        @import "dojo-1.7.0b2/dijit/css/dijitTests.css";
    </style>

    <!-- required: a default dijit theme: -->
    <link id="themeStyles" rel="stylesheet" href="/dojo-1.7.0b2/dijit/themes/claro/claro.css"/>

    <!-- required: dojo.js -->
    <script type="text/javascript" src="dojo-1.7.0b2/dojo/dojo.js"
        data-dojo-config="parseOnLoad: false, isDebug: true"></script>
    <script src="/socket.io/socket.io.js"></script>

    <script type="text/javascript">
        dojo.require("dijit.dijit"); // optimize: load dijit layer
        dojo.require("dojo.parser");    // scan page for widgets and instantiate them

        // widgets used inside subpage loaded via href=
        dojo.require("webasap.ui.T3View");

        function randomMessageId(){
            return Math.floor(Math.random() * 3) + 3;
        }

        dojo.addOnLoad(function(){
            dojo.parser.parse();
            var socket = io.connect('http://localhost:8000/')
                , t3 = socket.socket.of('/games/t3')
                , chat = socket.socket.of('/chat');

              t3.on('connect', function () {
                  console.log("t3.on'connect'");
                t3.emit('hi!');
              });
              
              t3.on('a message', function(data) {
                  console.log("received 'a message'");
                  console.debug(data);
              });

              chat.on('connect', function () {
                  console.log("chat connect.....");
                chat.emit('woot');
              });

              chat.on('chat message', function(data) {
                  console.log("received 'chat message'");
                  console.debug(data);
              });
        });
    </script>
</head>
<body>
    <div id="content" data-dojo-type="webasap.ui.T3View"></div>
    <!--
    <script>    
        $(document).ready(function() {
            console.log("Creating new io.Socket");
            var socket = io.connect("http://localhost:3000");
            console.log("Done creating io.Socket");
            var content = $('#content');

            socket.on('connect', function() {
                console.log("connect");
            });

            socket.on('message', function(message){
                console.log("message: " + message);
                content.prepend(message + '<br />');
            }) ;

            socket.on('disconnect', function() {
                console.log('disconnected');
                content.html("<b>Disconnected!</b>");
            });

        });
    </script>
    -->
</body>
</html>
